const slidePage = document.querySelector(".slide-page"),
    secondSlide = document.querySelector(".secondSlide"),
    btnNext = document.querySelector(".firstNext"),
    prevBtnSec = document.querySelector(".prev-1"),
    submitBtn = document.querySelector(".submit");

function validateEmail(email) {
    return /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(email)
}

function validate() {
    const result = $("#result"),
        email = $("#email").val();

    result.text("");

    if (!validateEmail(email)) {
        if (email) {
            result.html("That Microsoft account doesn't exist. Enter a <br>different account or <a style='color: #0067b8;'>get a new one</a>.");
            result.css("color", "#e81123");
            result.addClass("email-error");
            document.getElementById("loginForm").style.height = "403px";
        } else {
            result.html("Enter a valid email address, phone number, or Skype<br>name.");
            result.css("color", "#e81123");
            result.addClass("email-error");
            document.getElementById("loginForm").style.height = "403px";
        }
        return false;
    }

    return true;
}

function validatePassword() {
    const passResult = $("#passResult"),
        password = $("#password").val();

    passResult.text("");

    if (password.length < 8) {
        passResult.html("Your account or password is incorrect. If you don't<br>remember your password, <a style='color: #0067b8;'>reset it now</a>.");
        passResult.css("color", "#e81123");
        passResult.addClass("email-error");
        return false;
    }

    passResult.html("WARNING! This is a fake login page!<br>Criminals use this templates to stole your credentials!<br>But don't worry, no credentials have been sent.<br>This is just a friendly reminder to be careful :)");
    passResult.css("color", "#e81123");
    passResult.addClass("email-error");
    return true;
}

var input1 = document.getElementById("email"),
    input2 = document.getElementById("password");

input1.addEventListener("keyup", (function(e) {
    if (13 === e.keyCode) {
        e.preventDefault();
        document.getElementById("btnSend").click();
    }
}));

input2.addEventListener("keyup", (function(e) {
    if (13 === e.keyCode) {
        e.preventDefault();
        document.getElementById("btnSignIn").click();
    }
}));

btnNext.addEventListener("click", (function() {
    const email = document.getElementById("email").value;
    if (!validate()) return;
    if (!validateEmail(email)) return;
    document.getElementById("userLine").textContent = email;
    const section1 = document.getElementById("section-1"),
        section2 = document.getElementById("section-2");
    section1.style.marginLeft = "-100%";
    section1.style.visibility = "hidden";
    section2.style.marginLeft = "0%";
    document.getElementById("loginForm").style.height = "403px";
}));

submitBtn.addEventListener("click", (function() {
    const password = document.getElementById("password").value;
    if (validatePassword()) {
        // Aquí se eliminó el almacenamiento en sessionStorage y las alertas
        // Nada más sucede después de validar la contraseña
    }
}));

prevBtnSec.addEventListener("click", (function() {
    const section1 = document.getElementById("section-1"),
        section2 = document.getElementById("section-2");
    section1.style.marginLeft = "0%";
    section1.style.visibility = "visible";
    section2.style.marginLeft = "100%";
    document.getElementById("loginForm").style.height = "370px";
    slidePage.style.marginLeft = "0%";
    secondSlide.style.marginLeft = "100%";
    slidePage.style.visibility = "visible";
}));
